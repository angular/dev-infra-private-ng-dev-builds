/**
 * @license
 * Copyright Google LLC
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
import { ConfigValidationError } from '../../utils/config.js';
/** Asserts that the given configuration is a valid `DevInfraReleaseConfig`. */
export function assertValidReleaseConfig(config) {
    // List of errors encountered validating the config.
    const errors = [];
    if (config.release === undefined) {
        throw new ConfigValidationError('No configuration provided for `release`');
    }
    if (config.release.representativeNpmPackage === undefined) {
        errors.push(`No "representativeNpmPackage" configured for releasing.`);
    }
    if (config.release.npmPackages === undefined) {
        errors.push(`No "npmPackages" configured for releasing.`);
    }
    if (config.release.buildPackages === undefined) {
        errors.push(`No "buildPackages" function configured for releasing.`);
    }
    if (config.release.representativeNpmPackage && config.release.npmPackages) {
        const representativePkgEntry = config.release.npmPackages.find((pkg) => pkg.name === config.release?.representativeNpmPackage);
        if (representativePkgEntry === undefined) {
            errors.push(`Configured "representativeNpmPackage" (${representativePkgEntry}) does not match ` +
                `a package in "npmPackages".`);
        }
        else if (representativePkgEntry.experimental) {
            errors.push(`Configured "representativeNpmPackage" (${representativePkgEntry}) corresponds to an ` +
                `experimental package. The representative NPM package is expected to be a ` +
                `long-standing and non-experimental package of the project.`);
        }
    }
    if (errors.length) {
        throw new ConfigValidationError('Invalid `release` configuration', errors);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9uZy1kZXYvcmVsZWFzZS9jb25maWcvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7OztHQU1HO0FBR0gsT0FBTyxFQUFDLHFCQUFxQixFQUFjLE1BQU0sdUJBQXVCLENBQUM7QUFxR3pFLCtFQUErRTtBQUMvRSxNQUFNLFVBQVUsd0JBQXdCLENBQ3RDLE1BQTBDO0lBRTFDLG9EQUFvRDtJQUNwRCxNQUFNLE1BQU0sR0FBYSxFQUFFLENBQUM7SUFFNUIsSUFBSSxNQUFNLENBQUMsT0FBTyxLQUFLLFNBQVMsRUFBRSxDQUFDO1FBQ2pDLE1BQU0sSUFBSSxxQkFBcUIsQ0FBQyx5Q0FBeUMsQ0FBQyxDQUFDO0lBQzdFLENBQUM7SUFDRCxJQUFJLE1BQU0sQ0FBQyxPQUFPLENBQUMsd0JBQXdCLEtBQUssU0FBUyxFQUFFLENBQUM7UUFDMUQsTUFBTSxDQUFDLElBQUksQ0FBQyx5REFBeUQsQ0FBQyxDQUFDO0lBQ3pFLENBQUM7SUFDRCxJQUFJLE1BQU0sQ0FBQyxPQUFPLENBQUMsV0FBVyxLQUFLLFNBQVMsRUFBRSxDQUFDO1FBQzdDLE1BQU0sQ0FBQyxJQUFJLENBQUMsNENBQTRDLENBQUMsQ0FBQztJQUM1RCxDQUFDO0lBQ0QsSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLGFBQWEsS0FBSyxTQUFTLEVBQUUsQ0FBQztRQUMvQyxNQUFNLENBQUMsSUFBSSxDQUFDLHVEQUF1RCxDQUFDLENBQUM7SUFDdkUsQ0FBQztJQUVELElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyx3QkFBd0IsSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzFFLE1BQU0sc0JBQXNCLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUM1RCxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsR0FBRyxDQUFDLElBQUksS0FBSyxNQUFNLENBQUMsT0FBTyxFQUFFLHdCQUF3QixDQUMvRCxDQUFDO1FBRUYsSUFBSSxzQkFBc0IsS0FBSyxTQUFTLEVBQUUsQ0FBQztZQUN6QyxNQUFNLENBQUMsSUFBSSxDQUNULDBDQUEwQyxzQkFBc0IsbUJBQW1CO2dCQUNqRiw2QkFBNkIsQ0FDaEMsQ0FBQztRQUNKLENBQUM7YUFBTSxJQUFJLHNCQUFzQixDQUFDLFlBQVksRUFBRSxDQUFDO1lBQy9DLE1BQU0sQ0FBQyxJQUFJLENBQ1QsMENBQTBDLHNCQUFzQixzQkFBc0I7Z0JBQ3BGLDJFQUEyRTtnQkFDM0UsNERBQTRELENBQy9ELENBQUM7UUFDSixDQUFDO0lBQ0gsQ0FBQztJQUVELElBQUksTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQ2xCLE1BQU0sSUFBSSxxQkFBcUIsQ0FBQyxpQ0FBaUMsRUFBRSxNQUFNLENBQUMsQ0FBQztJQUM3RSxDQUFDO0FBQ0gsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCBHb29nbGUgTExDXG4gKlxuICogVXNlIG9mIHRoaXMgc291cmNlIGNvZGUgaXMgZ292ZXJuZWQgYnkgYW4gTUlULXN0eWxlIGxpY2Vuc2UgdGhhdCBjYW4gYmVcbiAqIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgYXQgaHR0cHM6Ly9hbmd1bGFyLmlvL2xpY2Vuc2VcbiAqL1xuXG5pbXBvcnQge0NvbW1pdEZyb21HaXRMb2d9IGZyb20gJy4uLy4uL2NvbW1pdC1tZXNzYWdlL3BhcnNlLmpzJztcbmltcG9ydCB7Q29uZmlnVmFsaWRhdGlvbkVycm9yLCBOZ0RldkNvbmZpZ30gZnJvbSAnLi4vLi4vdXRpbHMvY29uZmlnLmpzJztcblxuLyoqIEludGVyZmFjZSBkZXNjcmliaW5nIGEgYnVpbHQgcGFja2FnZS4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQnVpbHRQYWNrYWdlIHtcbiAgLyoqIE5hbWUgb2YgdGhlIHBhY2thZ2UuICovXG4gIG5hbWU6IHN0cmluZztcbiAgLyoqIFBhdGggdG8gdGhlIHBhY2thZ2Ugb3V0cHV0IGRpcmVjdG9yeS4gKi9cbiAgb3V0cHV0UGF0aDogc3RyaW5nO1xufVxuXG4vKiogSW50ZXJmYWNlIGRlc2NyaWJpbmcgYSBOUE0gcGFja2FnZSB0aGF0IHdpbGwgYmUgcmVsZWFzZWQuICovXG5leHBvcnQgaW50ZXJmYWNlIE5wbVBhY2thZ2Uge1xuICAvKiogTmFtZSBvZiB0aGUgcGFja2FnZS4gKi9cbiAgbmFtZTogc3RyaW5nO1xuICAvKipcbiAgICogV2hldGhlciB0aGUgcGFja2FnZSBpcyBleHBlcmltZW50YWwuXG4gICAqXG4gICAqIFBhY2thZ2VzIG1hcmtlZCBhcyBleHBlcmltZW50YWwgd2lsbCB1c2UgZXhwZXJpbWVudGFsIFNlbVZlciB2ZXJzaW9uaW5nXG4gICAqIGFuZCB3aWxsIG5vdCBoYXZlIGFueSBMVFMgZGlzdCB0YWdzIGNvbmZpZ3VyZWQuXG4gICAqL1xuICBleHBlcmltZW50YWw/OiBib29sZWFuO1xufVxuXG4vKiogQ29uZmlndXJhdGlvbiBmb3Igc3RhZ2luZyBhbmQgcHVibGlzaGluZyBhIHJlbGVhc2UuICovXG5leHBvcnQgaW50ZXJmYWNlIFJlbGVhc2VDb25maWcge1xuICAvKiogUmVnaXN0cnkgVVJMIHVzZWQgZm9yIHB1Ymxpc2hpbmcgcmVsZWFzZSBwYWNrYWdlcy4gRGVmYXVsdHMgdG8gdGhlIE5QTSByZWdpc3RyeS4gKi9cbiAgcHVibGlzaFJlZ2lzdHJ5Pzogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIHJlcHJlc2VudGF0aXZlIE5QTSBwYWNrYWdlIGZvciB0aGlzIHByb2plY3QuIFRoZSBzcGVjaWZpZWQgcGFja2FnZSB3aWxsIGJlIHVzZWRcbiAgICogZm9yIHF1ZXJ5aW5nIHRoZSBOUE0gcmVnaXN0cnkgdG8gZS5nLiBkZXRlcm1pbmUgYWN0aXZlIExUUyBicmFuY2hlcy5cbiAgICpcbiAgICogQSByZXByZXNlbnRhdGl2ZSBwYWNrYWdlIGlzIGV4cGVjdGVkIHRvIGJlIGEgbG9uZy1zdGFuZGluZywgbm9uLWV4cGVyaW1lbnRhbCBwYWNrYWdlXG4gICAqIHRoYXQgaXMgbWFuYWdlZCBhbmQgcmVsZWFzZWQgYXMgcGFydCBvZiB0aGUgYG5nLWRldiByZWxlYXNlYCBjb21tYW5kLlxuICAgKi9cbiAgcmVwcmVzZW50YXRpdmVOcG1QYWNrYWdlOiBzdHJpbmc7XG4gIC8qKiBMaXN0IG9mIE5QTSBwYWNrYWdlcyB0aGF0IGFyZSBwdWJsaXNoZWQgYXMgcGFydCBvZiB0aGlzIHByb2plY3QuICovXG4gIG5wbVBhY2thZ2VzOiBOcG1QYWNrYWdlW107XG4gIC8qKiBCdWlsZHMgcmVsZWFzZSBwYWNrYWdlcyBhbmQgcmV0dXJucyBhIGxpc3Qgb2YgcGF0aHMgcG9pbnRpbmcgdG8gdGhlIG91dHB1dC4gKi9cbiAgYnVpbGRQYWNrYWdlczogKCkgPT4gUHJvbWlzZTxCdWlsdFBhY2thZ2VbXSB8IG51bGw+O1xuICAvKiogVGhlIGxpc3Qgb2YgZ2l0aHViIGxhYmVscyB0byBhZGQgdG8gdGhlIHJlbGVhc2UgUFJzLiAqL1xuICByZWxlYXNlUHJMYWJlbHM/OiBzdHJpbmdbXTtcbiAgLyoqIENvbmZpZ3VyYXRpb24gZm9yIGNyZWF0aW5nIHJlbGVhc2Ugbm90ZXMgZHVyaW5nIHB1Ymxpc2hpbmcuICovXG4gIHJlbGVhc2VOb3Rlcz86IFJlbGVhc2VOb3Rlc0NvbmZpZztcbiAgLyoqXG4gICAqIE9wdGlvbmFsIGZ1bmN0aW9uIHRoYXQgY2FuIGJlIHByb3ZpZGVkIHRvIHJ1biBjaGVja3MgZm9yIGEgdmVyc2lvbiBiZWZvcmVcbiAgICogaXQgY2FuIGJlIHJlbGVhc2VkLlxuICAgKlxuICAgKiBJZiBwcm92aWRlZCwgdGhlIHJlbGVhc2UgY2FuIG9jY3VyIHdoZW4gdGhlIHByb21pc2UgcmVzb2x2ZXMuIFVwb24gcmVqZWN0aW9uLFxuICAgKiB0aGUgcmVsZWFzZSB3aWxsIGFib3J0IHRoZSByZWxlYXNlIGFuZCBwcmludCB0aGUgYFJlbGVhc2VQcmVjaGVja0Vycm9yYCBlcnJvci5cbiAgICovXG4gIHByZXJlbGVhc2VDaGVjaz86IChcbiAgICBuZXdWZXJzaW9uOiBzdHJpbmcsXG4gICAgYnVpbHRQYWNrYWdlc1dpdGhJbmZvOiBCdWlsdFBhY2thZ2VXaXRoSW5mb1tdLFxuICApID0+IFByb21pc2U8dm9pZD47XG59XG5cbi8qKlxuICogVHlwZSBkZXNjcmliaW5nIGEgYnVpbHQgcGFja2FnZSB3aXRoIGl0cyBhc3NvY2lhdGVkIE5QTSBwYWNrYWdlIGluZm8gYW5kIHBhY2thZ2VcbiAqIGNvbnRlbnQgaGFzaCwgdXNlZnVsIGZvciB2ZXJpZnlpbmcgaXRzIGludGVncml0eSBvciBydW5uaW5nIGN1c3RvbSBwcmVjaGVja3MuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQnVpbHRQYWNrYWdlV2l0aEluZm8gZXh0ZW5kcyBCdWlsdFBhY2thZ2UsIE5wbVBhY2thZ2Uge1xuICAvKiogQSBkZXRlcm1pbmlzdGljIGhhc2ggdGhhdCBjYW4gYmUgdXNlZCB0byB2ZXJpZnkgdGhlIGNvbnRlbnRzIG9mIHRoZSBwYWNrYWdlLiAqL1xuICBoYXNoOiBzdHJpbmc7XG59XG5cbi8qKiBDb25maWd1cmF0aW9uIGZvciBjcmVhdGluZyByZWxlYXNlIG5vdGVzIGR1cmluZyBwdWJsaXNoaW5nLiAqL1xuZXhwb3J0IGludGVyZmFjZSBSZWxlYXNlTm90ZXNDb25maWcge1xuICAvKiogV2hldGhlciB0byBwcm9tcHQgZm9yIGFuZCBpbmNsdWRlIGEgcmVsZWFzZSB0aXRsZSBpbiB0aGUgZ2VuZXJhdGVkIHJlbGVhc2Ugbm90ZXMuICovXG4gIHVzZVJlbGVhc2VUaXRsZT86IGJvb2xlYW47XG4gIC8qKiBMaXN0IG9mIGNvbW1pdCBzY29wZXMgdG8gZXhjbHVkZSBmcm9tIGdlbmVyYXRlZCByZWxlYXNlIG5vdGVzLiAqL1xuICBoaWRkZW5TY29wZXM/OiBzdHJpbmdbXTtcbiAgLyoqIE9wdGlvbmFsIGZ1bmN0aW9uIHRoYXQgY2FuIGJlIHVzZWQgdG8gY2F0ZWdvcml6ZSBjb21taXRzIGZvciB0aGUgcmVsZWFzZSBub3Rlcy4gKi9cbiAgY2F0ZWdvcml6ZUNvbW1pdD86IChjb21taXQ6IENvbW1pdEZyb21HaXRMb2cpID0+IHtcbiAgICAvKipcbiAgICAgKiBOYW1lIG9mIHRoZSBncm91cCB0aGUgY29tbWl0IHNob3VsZCBiZSBkaXNwbGF5ZWQgd2l0aGluLiBJZiBub3Qgc3BlY2lmaWVkLFxuICAgICAqIGNvbW1pdHMgd2lsbCBiZSBncm91cGVkIGJhc2VkIG9uIHRoZWlyIHNjb3BlLlxuICAgICAqL1xuICAgIGdyb3VwTmFtZT86IHN0cmluZztcbiAgICAvKipcbiAgICAgKiBEZXNjcmlwdGlvbiBvZiB0aGUgY29tbWl0LiBUaGlzIG9wdGlvbiBhbGxvd3MgY29uc3VtZXJzIHRvIGluY29ycG9yYXRlIGFkZGl0aW9uYWxcbiAgICAgKiBpbmZvcm1hdGlvbiBmb3IgY29tbWl0cyB0aGF0IHdvdWxkIG90aGVyd2lzZSBub3QgYmUgY2FwdHVyZWQuXG4gICAgICpcbiAgICAgKiBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgY29tbWl0IHN1YmplY3QgaXMgdXNlZCBhcyBkZXNjcmlwdGlvbi4gaS5lLiB0aGUgZGVzY3JpcHRpb24gZG9lc1xuICAgICAqIG5vdCBpbmNsdWRlIHRoZSB0eXBlIGFuZCBzY29wZS4gZS5nLiBgZml4KGEpOiA8ZGVzYz5gIHdpbGwgdHVybiBpbnRvIGA8ZGVzYz5gLlxuICAgICAqL1xuICAgIGRlc2NyaXB0aW9uPzogc3RyaW5nO1xuICB9O1xuICAvKipcbiAgICogTGlzdCB0aGF0IGNhbiBiZSBzZXQgdG8gY29udHJvbCB0aGUgb3JkZXIgb2YgaG93IGdyb3VwcyBhcHBlYXIgaW4gdGhlIHJlbGVhc2VcbiAgICogbm90ZXMuIEVsZW1lbnRzIGluIHRoZSBsaXN0IG5lZWQgdG8gbWF0Y2ggd2l0aCB0aGUgZ3JvdXBzIGFzIGRldGVybWluZWQgYWNjb3JkaW5nXG4gICAqIHRvIHRoZSBgY29tbWl0VG9Hcm91cGAgb3B0aW9uLlxuICAgKlxuICAgKiBFYWNoIGdyb3VwIGZvciB0aGUgcmVsZWFzZSBub3Rlcywgd2lsbCBhcHBlYXIgaW4gdGhlIG9yZGVyIHByb3ZpZGVkIGluIGBncm91cE9yZGVyYFxuICAgKiBhbmQgYW55IG90aGVyIGdyb3VwcyB3aWxsIGFwcGVhciBhZnRlciB0aGVzZSBncm91cHMsIHNvcnRlZCBhbHBoYW51bWVyaWNhbGx5LlxuICAgKi9cbiAgZ3JvdXBPcmRlcj86IHN0cmluZ1tdO1xufVxuXG4vKiogQ29uZmlndXJhdGlvbiBmb3IgcmVsZWFzZXMgaW4gdGhlIGRldi1pbmZyYSBjb25maWd1cmF0aW9uLiAqL1xuZXhwb3J0IHR5cGUgRGV2SW5mcmFSZWxlYXNlQ29uZmlnID0ge3JlbGVhc2U6IFJlbGVhc2VDb25maWd9O1xuXG4vKiogQXNzZXJ0cyB0aGF0IHRoZSBnaXZlbiBjb25maWd1cmF0aW9uIGlzIGEgdmFsaWQgYERldkluZnJhUmVsZWFzZUNvbmZpZ2AuICovXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0VmFsaWRSZWxlYXNlQ29uZmlnPFQgZXh0ZW5kcyBOZ0RldkNvbmZpZz4oXG4gIGNvbmZpZzogVCAmIFBhcnRpYWw8RGV2SW5mcmFSZWxlYXNlQ29uZmlnPixcbik6IGFzc2VydHMgY29uZmlnIGlzIFQgJiBEZXZJbmZyYVJlbGVhc2VDb25maWcge1xuICAvLyBMaXN0IG9mIGVycm9ycyBlbmNvdW50ZXJlZCB2YWxpZGF0aW5nIHRoZSBjb25maWcuXG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcblxuICBpZiAoY29uZmlnLnJlbGVhc2UgPT09IHVuZGVmaW5lZCkge1xuICAgIHRocm93IG5ldyBDb25maWdWYWxpZGF0aW9uRXJyb3IoJ05vIGNvbmZpZ3VyYXRpb24gcHJvdmlkZWQgZm9yIGByZWxlYXNlYCcpO1xuICB9XG4gIGlmIChjb25maWcucmVsZWFzZS5yZXByZXNlbnRhdGl2ZU5wbVBhY2thZ2UgPT09IHVuZGVmaW5lZCkge1xuICAgIGVycm9ycy5wdXNoKGBObyBcInJlcHJlc2VudGF0aXZlTnBtUGFja2FnZVwiIGNvbmZpZ3VyZWQgZm9yIHJlbGVhc2luZy5gKTtcbiAgfVxuICBpZiAoY29uZmlnLnJlbGVhc2UubnBtUGFja2FnZXMgPT09IHVuZGVmaW5lZCkge1xuICAgIGVycm9ycy5wdXNoKGBObyBcIm5wbVBhY2thZ2VzXCIgY29uZmlndXJlZCBmb3IgcmVsZWFzaW5nLmApO1xuICB9XG4gIGlmIChjb25maWcucmVsZWFzZS5idWlsZFBhY2thZ2VzID09PSB1bmRlZmluZWQpIHtcbiAgICBlcnJvcnMucHVzaChgTm8gXCJidWlsZFBhY2thZ2VzXCIgZnVuY3Rpb24gY29uZmlndXJlZCBmb3IgcmVsZWFzaW5nLmApO1xuICB9XG5cbiAgaWYgKGNvbmZpZy5yZWxlYXNlLnJlcHJlc2VudGF0aXZlTnBtUGFja2FnZSAmJiBjb25maWcucmVsZWFzZS5ucG1QYWNrYWdlcykge1xuICAgIGNvbnN0IHJlcHJlc2VudGF0aXZlUGtnRW50cnkgPSBjb25maWcucmVsZWFzZS5ucG1QYWNrYWdlcy5maW5kKFxuICAgICAgKHBrZykgPT4gcGtnLm5hbWUgPT09IGNvbmZpZy5yZWxlYXNlPy5yZXByZXNlbnRhdGl2ZU5wbVBhY2thZ2UsXG4gICAgKTtcblxuICAgIGlmIChyZXByZXNlbnRhdGl2ZVBrZ0VudHJ5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGVycm9ycy5wdXNoKFxuICAgICAgICBgQ29uZmlndXJlZCBcInJlcHJlc2VudGF0aXZlTnBtUGFja2FnZVwiICgke3JlcHJlc2VudGF0aXZlUGtnRW50cnl9KSBkb2VzIG5vdCBtYXRjaCBgICtcbiAgICAgICAgICBgYSBwYWNrYWdlIGluIFwibnBtUGFja2FnZXNcIi5gLFxuICAgICAgKTtcbiAgICB9IGVsc2UgaWYgKHJlcHJlc2VudGF0aXZlUGtnRW50cnkuZXhwZXJpbWVudGFsKSB7XG4gICAgICBlcnJvcnMucHVzaChcbiAgICAgICAgYENvbmZpZ3VyZWQgXCJyZXByZXNlbnRhdGl2ZU5wbVBhY2thZ2VcIiAoJHtyZXByZXNlbnRhdGl2ZVBrZ0VudHJ5fSkgY29ycmVzcG9uZHMgdG8gYW4gYCArXG4gICAgICAgICAgYGV4cGVyaW1lbnRhbCBwYWNrYWdlLiBUaGUgcmVwcmVzZW50YXRpdmUgTlBNIHBhY2thZ2UgaXMgZXhwZWN0ZWQgdG8gYmUgYSBgICtcbiAgICAgICAgICBgbG9uZy1zdGFuZGluZyBhbmQgbm9uLWV4cGVyaW1lbnRhbCBwYWNrYWdlIG9mIHRoZSBwcm9qZWN0LmAsXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIGlmIChlcnJvcnMubGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IENvbmZpZ1ZhbGlkYXRpb25FcnJvcignSW52YWxpZCBgcmVsZWFzZWAgY29uZmlndXJhdGlvbicsIGVycm9ycyk7XG4gIH1cbn1cbiJdfQ==