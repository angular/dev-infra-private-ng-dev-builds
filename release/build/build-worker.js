/**
 * @license
 * Copyright Google LLC
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
/*
 * This file will be spawned as a separate process when the `ng-dev release build` command is
 * invoked. A separate process allows us to hide any superfluous stdout output from arbitrary
 * build commands that we cannot control. This is necessary as the `ng-dev release build` command
 * supports stdout JSON output that should be parsable and not polluted from other stdout messages.
 */
import { getConfig } from '../../utils/config.js';
import { assertValidReleaseConfig } from '../config/index.js';
// Start the release package building.
main().catch((e) => {
    console.error(e);
    throw e;
});
/** Main function for building the release packages. */
async function main() {
    if (process.send === undefined) {
        throw Error('This script needs to be invoked as a NodeJS worker.');
    }
    const config = await getConfig();
    assertValidReleaseConfig(config);
    const builtPackages = await config.release.buildPackages();
    // Transfer the built packages back to the parent process.
    process.send(builtPackages);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVpbGQtd29ya2VyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vbmctZGV2L3JlbGVhc2UvYnVpbGQvYnVpbGQtd29ya2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7R0FNRztBQUVIOzs7OztHQUtHO0FBRUgsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLHVCQUF1QixDQUFDO0FBQ2hELE9BQU8sRUFBQyx3QkFBd0IsRUFBQyxNQUFNLG9CQUFvQixDQUFDO0FBRTVELHNDQUFzQztBQUN0QyxJQUFJLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRTtJQUNqQixPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2pCLE1BQU0sQ0FBQyxDQUFDO0FBQ1YsQ0FBQyxDQUFDLENBQUM7QUFFSCx1REFBdUQ7QUFDdkQsS0FBSyxVQUFVLElBQUk7SUFDakIsSUFBSSxPQUFPLENBQUMsSUFBSSxLQUFLLFNBQVMsRUFBRSxDQUFDO1FBQy9CLE1BQU0sS0FBSyxDQUFDLHFEQUFxRCxDQUFDLENBQUM7SUFDckUsQ0FBQztJQUVELE1BQU0sTUFBTSxHQUFHLE1BQU0sU0FBUyxFQUFFLENBQUM7SUFDakMsd0JBQXdCLENBQUMsTUFBTSxDQUFDLENBQUM7SUFFakMsTUFBTSxhQUFhLEdBQUcsTUFBTSxNQUFNLENBQUMsT0FBTyxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBRTNELDBEQUEwRDtJQUMxRCxPQUFPLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0FBQzlCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgR29vZ2xlIExMQ1xuICpcbiAqIFVzZSBvZiB0aGlzIHNvdXJjZSBjb2RlIGlzIGdvdmVybmVkIGJ5IGFuIE1JVC1zdHlsZSBsaWNlbnNlIHRoYXQgY2FuIGJlXG4gKiBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGF0IGh0dHBzOi8vYW5ndWxhci5pby9saWNlbnNlXG4gKi9cblxuLypcbiAqIFRoaXMgZmlsZSB3aWxsIGJlIHNwYXduZWQgYXMgYSBzZXBhcmF0ZSBwcm9jZXNzIHdoZW4gdGhlIGBuZy1kZXYgcmVsZWFzZSBidWlsZGAgY29tbWFuZCBpc1xuICogaW52b2tlZC4gQSBzZXBhcmF0ZSBwcm9jZXNzIGFsbG93cyB1cyB0byBoaWRlIGFueSBzdXBlcmZsdW91cyBzdGRvdXQgb3V0cHV0IGZyb20gYXJiaXRyYXJ5XG4gKiBidWlsZCBjb21tYW5kcyB0aGF0IHdlIGNhbm5vdCBjb250cm9sLiBUaGlzIGlzIG5lY2Vzc2FyeSBhcyB0aGUgYG5nLWRldiByZWxlYXNlIGJ1aWxkYCBjb21tYW5kXG4gKiBzdXBwb3J0cyBzdGRvdXQgSlNPTiBvdXRwdXQgdGhhdCBzaG91bGQgYmUgcGFyc2FibGUgYW5kIG5vdCBwb2xsdXRlZCBmcm9tIG90aGVyIHN0ZG91dCBtZXNzYWdlcy5cbiAqL1xuXG5pbXBvcnQge2dldENvbmZpZ30gZnJvbSAnLi4vLi4vdXRpbHMvY29uZmlnLmpzJztcbmltcG9ydCB7YXNzZXJ0VmFsaWRSZWxlYXNlQ29uZmlnfSBmcm9tICcuLi9jb25maWcvaW5kZXguanMnO1xuXG4vLyBTdGFydCB0aGUgcmVsZWFzZSBwYWNrYWdlIGJ1aWxkaW5nLlxubWFpbigpLmNhdGNoKChlKSA9PiB7XG4gIGNvbnNvbGUuZXJyb3IoZSk7XG4gIHRocm93IGU7XG59KTtcblxuLyoqIE1haW4gZnVuY3Rpb24gZm9yIGJ1aWxkaW5nIHRoZSByZWxlYXNlIHBhY2thZ2VzLiAqL1xuYXN5bmMgZnVuY3Rpb24gbWFpbigpIHtcbiAgaWYgKHByb2Nlc3Muc2VuZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhyb3cgRXJyb3IoJ1RoaXMgc2NyaXB0IG5lZWRzIHRvIGJlIGludm9rZWQgYXMgYSBOb2RlSlMgd29ya2VyLicpO1xuICB9XG5cbiAgY29uc3QgY29uZmlnID0gYXdhaXQgZ2V0Q29uZmlnKCk7XG4gIGFzc2VydFZhbGlkUmVsZWFzZUNvbmZpZyhjb25maWcpO1xuXG4gIGNvbnN0IGJ1aWx0UGFja2FnZXMgPSBhd2FpdCBjb25maWcucmVsZWFzZS5idWlsZFBhY2thZ2VzKCk7XG5cbiAgLy8gVHJhbnNmZXIgdGhlIGJ1aWx0IHBhY2thZ2VzIGJhY2sgdG8gdGhlIHBhcmVudCBwcm9jZXNzLlxuICBwcm9jZXNzLnNlbmQoYnVpbHRQYWNrYWdlcyk7XG59XG4iXX0=