{"version":3,"file":"cli.js","sourceRoot":"","sources":["cli.ts"],"names":[],"mappings":"AAeA,OAAO,EAAC,SAAS,EAAC,MAAM,0BAA0B,CAAC;AAEnD,OAAO,EAAC,IAAI,EAAE,KAAK,EAAE,GAAG,EAAC,MAAM,2BAA2B,CAAC;AAC3D,OAAO,EAAC,OAAO,EAAC,MAAM,2BAA2B,CAAC;AAClD,OAAO,EAAC,wBAAwB,EAAC,MAAM,uBAAuB,CAAC;AAC/D,OAAO,EAAC,UAAU,EAAC,MAAM,iCAAiC,CAAC;AAO3D,SAAS,OAAO,CAAC,IAAU;IACzB,OAAO,IAAI,CAAC,UAAU,CAAC,SAAS,EAAE;QAChC,IAAI,EAAE,QAAQ;QACd,YAAY,EAAE,IAAI;QAClB,WAAW,EAAE,2BAA2B;KACzC,CAAC,CAAC;AACL,CAAC;AAGD,KAAK,UAAU,OAAO,CAAC,IAA+C;IACpE,MAAM,EAAC,OAAO,EAAC,GAAG,IAAI,CAAC;IACvB,MAAM,MAAM,GAAG,MAAM,SAAS,EAAE,CAAC;IACjC,wBAAwB,CAAC,MAAM,CAAC,CAAC;IACjC,MAAM,EAAC,WAAW,EAAE,eAAe,EAAC,GAAG,MAAM,CAAC,OAAO,CAAC;IAEtD,GAAG,CAAC,KAAK,CAAC,aAAa,OAAO,sCAAsC,CAAC,CAAC;IACtE,MAAM,OAAO,GAAG,IAAI,OAAO,CAAC,EAAE,CAAC,CAAC;IAEhC,KAAK,MAAM,GAAG,IAAI,WAAW,EAAE,CAAC;QAC9B,OAAO,CAAC,MAAM,CAAC,8BAA8B,GAAG,CAAC,IAAI,GAAG,CAAC,CAAC;QAE1D,IAAI,CAAC;YACH,MAAM,UAAU,CAAC,uBAAuB,CAAC,GAAG,CAAC,IAAI,EAAE,OAAO,EAAE,eAAe,CAAC,CAAC;YAC7E,GAAG,CAAC,KAAK,CAAC,yBAAyB,OAAO,uBAAuB,GAAG,CAAC,IAAI,IAAI,CAAC,CAAC;QACjF,CAAC;QAAC,OAAO,CAAC,EAAE,CAAC;YACX,OAAO,CAAC,QAAQ,EAAE,CAAC;YACnB,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YACb,GAAG,CAAC,KAAK,CAAC,gEAAgE,GAAG,CAAC,IAAI,IAAI,CAAC,CAAC;YACxF,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAClB,CAAC;IACH,CAAC;IAED,OAAO,CAAC,QAAQ,EAAE,CAAC;IACnB,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,kBAAkB,IAAI,CAAC,OAAO,CAAC,kCAAkC,CAAC,CAAC,CAAC;AACrF,CAAC;AAGD,MAAM,CAAC,MAAM,8BAA8B,GAAsD;IAC/F,OAAO;IACP,OAAO;IACP,OAAO,EAAE,mBAAmB;IAC5B,QAAQ,EAAE,wDAAwD;CACnE,CAAC","sourcesContent":["/**\n * @license\n * Copyright Google LLC\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\n// ---- **IMPORTANT** ----\n// This command is part of our external commands invoked by the release publish\n// command. Before making changes, keep in mind that more recent `ng-dev` versions\n// can still invoke this command.\n// ------------------------\n\nimport {Arguments, Argv, CommandModule} from 'yargs';\nimport {getConfig} from '../../../utils/config.js';\n\nimport {bold, green, Log} from '../../../utils/logging.js';\nimport {Spinner} from '../../../utils/spinner.js';\nimport {assertValidReleaseConfig} from '../../config/index.js';\nimport {NpmCommand} from '../../versioning/npm-command.js';\n\n/** Command line options for deleting a NPM dist tag. */\nexport interface ReleaseNpmDistTagDeleteOptions {\n  tagName: string;\n}\n\nfunction builder(args: Argv): Argv<ReleaseNpmDistTagDeleteOptions> {\n  return args.positional('tagName', {\n    type: 'string',\n    demandOption: true,\n    description: 'Name of the NPM dist tag.',\n  });\n}\n\n/** Yargs command handler for deleting an NPM dist tag. */\nasync function handler(args: Arguments<ReleaseNpmDistTagDeleteOptions>) {\n  const {tagName} = args;\n  const config = await getConfig();\n  assertValidReleaseConfig(config);\n  const {npmPackages, publishRegistry} = config.release;\n\n  Log.debug(`Deleting \"${tagName}\" NPM dist tag for release packages.`);\n  const spinner = new Spinner('');\n\n  for (const pkg of npmPackages) {\n    spinner.update(`Deleting NPM dist tag for \"${pkg.name}\"`);\n\n    try {\n      await NpmCommand.deleteDistTagForPackage(pkg.name, tagName, publishRegistry);\n      Log.debug(`Successfully deleted \"${tagName}\" NPM dist tag for \"${pkg.name}\".`);\n    } catch (e) {\n      spinner.complete();\n      Log.error(e);\n      Log.error(`  ✘   An error occurred while deleting the NPM dist tag for \"${pkg.name}\".`);\n      process.exit(1);\n    }\n  }\n\n  spinner.complete();\n  Log.info(green(`  ✓   Deleted \"${bold(tagName)}\" NPM dist tag for all packages.`));\n}\n\n/** CLI command module for deleting an NPM dist tag. */\nexport const ReleaseNpmDistTagDeleteCommand: CommandModule<{}, ReleaseNpmDistTagDeleteOptions> = {\n  builder,\n  handler,\n  command: 'delete <tag-name>',\n  describe: 'Deletes a given NPM dist tag for all release packages.',\n};\n"]}