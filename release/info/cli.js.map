{"version":3,"file":"cli.js","sourceRoot":"","sources":["cli.ts"],"names":[],"mappings":"AAgBA,OAAO,EAAC,SAAS,EAAC,MAAM,+BAA+B,CAAC;AACxD,OAAO,EAAC,wBAAwB,EAAa,MAAM,oBAAoB,CAAC;AACxE,OAAO,EAAC,mBAAmB,EAAC,MAAM,wCAAwC,CAAC;AAC3E,OAAO,EAAC,wBAAwB,EAAC,MAAM,sCAAsC,CAAC;AAC9E,OAAO,EAAC,iBAAiB,EAAqB,MAAM,wBAAwB,CAAC;AAC7E,OAAO,EAAC,SAAS,EAAC,MAAM,uBAAuB,CAAC;AAgBhD,SAAS,OAAO,CAAC,IAAU;IACzB,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE;QACzB,IAAI,EAAE,SAAS;QACf,WAAW,EAAE,0DAA0D;QACvE,OAAO,EAAE,KAAK;KACf,CAAC,CAAC;AACL,CAAC;AAGD,KAAK,UAAU,OAAO,CAAC,IAAmC;IACxD,MAAM,MAAM,GAAG,MAAM,SAAS,EAAE,CAAC;IACjC,wBAAwB,CAAC,MAAM,CAAC,CAAC;IAGjC,IAAI,IAAI,CAAC,IAAI,EAAE,CAAC;QACd,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAwB,MAAM,CAAC,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;QACrF,OAAO;IACT,CAAC;IAED,MAAM,GAAG,GAAG,MAAM,SAAS,CAAC,GAAG,EAAE,CAAC;IAClC,MAAM,cAAc,GAAG,iBAAiB,CAAC,GAAG,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;IAC5D,MAAM,IAAI,GAAuB,EAAC,GAAG,EAAE,GAAG,CAAC,MAAM,EAAE,GAAG,GAAG,CAAC,YAAY,EAAE,cAAc,EAAC,CAAC;IACxF,MAAM,aAAa,GAAG,MAAM,mBAAmB,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;IAG5D,MAAM,wBAAwB,CAAC,aAAa,EAAE,MAAM,CAAC,OAAO,CAAC,CAAC;AAChE,CAAC;AAGD,MAAM,CAAC,MAAM,wBAAwB,GAA0C;IAC7E,OAAO;IACP,OAAO;IACP,OAAO,EAAE,MAAM;IACf,QAAQ,EAAE,mDAAmD;CAC9D,CAAC","sourcesContent":["/**\n * @license\n * Copyright Google LLC\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\n// ---- **IMPORTANT** ----\n// This command is part of our external commands invoked by the release publish\n// command. Before making changes, keep in mind that more recent `ng-dev` versions\n// can still invoke this command.\n// ------------------------\n\nimport {Argv, Arguments, CommandModule} from 'yargs';\n\nimport {GitClient} from '../../utils/git/git-client.js';\nimport {assertValidReleaseConfig, NpmPackage} from '../config/index.js';\nimport {ActiveReleaseTrains} from '../versioning/active-release-trains.js';\nimport {printActiveReleaseTrains} from '../versioning/print-active-trains.js';\nimport {getNextBranchName, ReleaseRepoWithApi} from '../versioning/index.js';\nimport {getConfig} from '../../utils/config.js';\n\n/**\n * Type describing the JSON output of this command.\n *\n * @important When changing this, make sure the release action\n *   invocation is updated as well.\n */\nexport type ReleaseInfoJsonStdout = {npmPackages: NpmPackage[]};\n\n/** Command line options for printing release information. */\nexport interface ReleaseInfoOptions {\n  json: boolean;\n}\n\n/** Yargs command builder for the `ng-dev release info` command. */\nfunction builder(argv: Argv): Argv<ReleaseInfoOptions> {\n  return argv.option('json', {\n    type: 'boolean',\n    description: 'Whether information should be written as JSON to stdout.',\n    default: false,\n  });\n}\n\n/** Yargs command handler for printing release information. */\nasync function handler(argv: Arguments<ReleaseInfoOptions>) {\n  const config = await getConfig();\n  assertValidReleaseConfig(config);\n\n  // If JSON output is requested, print the information as JSON to stdout.\n  if (argv.json) {\n    process.stdout.write(JSON.stringify(<ReleaseInfoJsonStdout>config.release, null, 2));\n    return;\n  }\n\n  const git = await GitClient.get();\n  const nextBranchName = getNextBranchName(git.config.github);\n  const repo: ReleaseRepoWithApi = {api: git.github, ...git.remoteConfig, nextBranchName};\n  const releaseTrains = await ActiveReleaseTrains.fetch(repo);\n\n  // Print the active release trains.\n  await printActiveReleaseTrains(releaseTrains, config.release);\n}\n\n/** CLI command module for retrieving release information. */\nexport const ReleaseInfoCommandModule: CommandModule<{}, ReleaseInfoOptions> = {\n  builder,\n  handler,\n  command: 'info',\n  describe: 'Prints information for the current release state.',\n};\n"]}